<html>
    <head>
        <title>Plenty of Fish</title>
        <link rel="stylesheet" href="fish.css" type="text/css">
    </head>
    <body>
    
		<canvas id="view">No Support for canvas!</canvas>
		
        <script type="text/javascript" src="jim.js"></script>
		<script type="text/javascript" src="hunter.js"></script>

		<script type="text/javascript">			
			
			var frame = 0;
            var waterFrame = 0;
			function main() {
				view.clear();
                
                if (waterFrame >= Water.frames) waterFrame = 0;
                else waterFrame++; 
                for (var i in Water.all) {
					Water.all[i].render(view.ctx, waterFrame);
				}

                aquarium.render(view.ctx);
                
                frame = (frame + 1) % Fish.frames;
                for (var i in Fish.all) {
					Fish.all[i].render(view.ctx, frame);
				}
			}

			// Found out the fastest way to clear an element is blank space; we may need 2 large canvases:
			// 1 - for the main action in front
			// 2 - for the background (water, aquarium, etc)
			
			view = new View('view');			
			var view, water, aquarium;
			
			
			water = new Water(view.canvas.width, view.canvas.height);
			water.prepare();
	        
	        aquarium = new Aquarium(view.canvas.width, view.canvas.height);
	        aquarium.prepare();
						
			for (var x = 0; x < 5; x++) {
				for (var y = 0; y < 3; y++) {
					var fish = new Fish(50 + 200 * x, 50 + 150 * y, 120, 100);
				}
			}
			
			window.onresize = function() {
				view.resize(window.innerWidth || document.documentElement.clientWidth, window.innerHeight || document.documentElement.clientHeight);				
			}
	 
			window.onresize();
			
			setInterval(main, 1000 / 45);

		</script>

	</body>
</html>